var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var c="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return c?c.call(b):$jscomp.arrayIterator(b)};
var currentRole,currentAccName,chooseJobModal,updateRoleModalBtn,closeModalBtn,setDefaultRoleBtn,changeRoleBtn,accNameInput,accessesGlobal,rolesGlobal,typistAccessCount,modalHeaderTitle,accessId,roleRequest,ACCESS_URL="../api/v1/access/?out",SET_DEFAULT_ACCESS_URL="../api/v1/users/set-default/",ROLES_FOR_ACCOUNT_URL="../api/v1/access?out&acc_id=",ROLES_COUNT_FOR_ACCOUNT_URL="../api/v1/access?out&count",CREATE_ACC_URL="../api/v1/accounts/?out",CHANGE_ROLE_HEADER='<i class="fas fa-wrench"></i>&nbsp;Change Role',
SET_DEFAULT_ROLE_HEADER='<i class="fas fa-user-edit"></i>&nbsp;Set Default',accountBox,roleBox,setDefaultModal,accountsArray=[],loading,loadingText,roleIsset;
$(document).ready(function(){function b(){"hel@#l6o".search();if(""===accNameInput.val()||50<=accNameInput.val().length||-1!==accNameInput.val().search(/[!@#$%^&*)(+=._-]+/g))return accNameInput.addClass("is-invalid"),accNameInput.removeClass("is-valid"),!1;accNameInput.removeClass("is-invalid");accNameInput.addClass("is-valid");return!0}function c(a,b){var c=new FormData;c.append("acc_id",a);c.append("acc_role",b);$.ajax({type:"POST",url:ACCESS_URL,processData:!1,data:convertToSearchParam(c),success:function(a){chooseJobModal.modal("hide");
location.reload()},error:function(a){}})}function d(a){roleBox.selectpicker("destroy");null!=roleRequest&&roleRequest.abort();roleRequest=$.ajax({url:ROLES_FOR_ACCOUNT_URL+a,method:"GET",success:function(a){rolesGlobal=a;updateRoleModalBtn.removeAttr("disabled");var b=document.getElementById("roleBox");b.innerHTML="";a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,b.innerHTML+="<option value='"+d.acc_role+"'>"+d.role_desc+"</option>";roleBox.selectpicker({liveSearch:!0,liveSearchPlaceholder:"Choose Role"});
roleBox.selectpicker("refresh");roleIsset?changeLoading(!1):1==accessesGlobal.length?1==rolesGlobal.length?c(rolesGlobal[0].acc_id,rolesGlobal[0].acc_role):(chooseJobModal.modal("show"),changeLoading(!1)):(0!=accessesGlobal.length&&chooseJobModal.modal("show"),changeLoading(!1))}})}loading=document.getElementById("overlay");changeLoading(!0);(new EnjoyHint({})).set([{"next .navbar-text":"This is a test to focus on the navbar title in the landing page"},{"next #adminCard":"This is the admin card in circle",
shape:"circle"},{selector:"#typistCard",description:"This is the typist card",skipButton:{text:"Finish"}}]);loadingText=$("#loadingText");accNameInput=$("#accNameTxt");currentRole=$("#currentRole");currentAccName=$("#currentAccountName");updateRoleModalBtn=$("#updateRoleBtn");closeModalBtn=$("#closeModalBtn");changeRoleBtn=$("#changeRoleBtn");modalHeaderTitle=$("#modalHeaderTitle");setDefaultRoleBtn=$("#setDefaultRoleBtn");accessId=$("#accessId");accountBox=$("#accountBox");roleBox=$("#roleBox");
chooseJobModal=$("#modal");closeModalBtn.on("click",function(a){chooseJobModal.modal("hide")});changeRoleBtn.on("click",function(a){setModalUI(!1);chooseJobModal.modal("show")});accNameInput.keyup(function(){b()});$("#createAdminAccBtn").on("click",function(a){b()&&(changeLoading(!0,"Creating account..."),$("#createAccModal").modal("hide"),a=new FormData,a.append("acc_name",accNameInput.val()),$.ajax({type:"POST",url:CREATE_ACC_URL,data:a,processData:!1,contentType:!1,success:function(){loadingText.html("Account created!, redirecting..");
setTimeout(function(){location.reload()},1E3)},error:function(a){changeLoading(!1);$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{btnClass:"btn-red"}}})}}))});setDefaultRoleBtn.on("click",function(a){setModalUI(!0);chooseJobModal.modal()});(function(a){a=void 0===a?0:a;var b="";a&&(b="&type="+a);$.ajax({url:ROLES_COUNT_FOR_ACCOUNT_URL+b,method:"GET",success:function(a){typistAccessCount=a.count;$("#typistCount").html(typistAccessCount);0<typistAccessCount?($("#typist0").remove(),
$("#alertT0").remove()):($("#typist1").remove(),$("#alertT1").remove())}})})(3);updateRoleModalBtn.on("click",function(a){updateRoleModalBtn.attr("disabled","disabled");changeLoading(!0,"Setting role, please wait..");a=new FormData;a.append("acc_id",accountBox.selectpicker("val"));a.append("acc_role",roleBox.selectpicker("val"));$.ajax({type:"POST",url:setDefaultModal?SET_DEFAULT_ACCESS_URL:ACCESS_URL,processData:!1,data:convertToSearchParam(a),success:function(a){chooseJobModal.modal("hide");location.reload()},
error:function(a){changeLoading(!1);$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{btnClass:"btn-red",action:function(){updateRoleModalBtn.removeAttr("disabled");return!0}}}})}})});$.ajax({url:ACCESS_URL,method:"GET",success:function(a){accessesGlobal=a;var b=document.getElementById("accountBox");a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,-1==accountsArray.indexOf(c.acc_id)&&(accountsArray.push(c.acc_id),b.innerHTML+="<option value='"+c.acc_id+
"'>"+c.acc_name+"</option>");accountBox.selectpicker({liveSearch:!0,liveSearchPlaceholder:"Choose Account"});d(accountBox.selectpicker("val"));accountBox.on("changed.bs.select",function(a,b,c,e){changeLoading(!0,"Loading roles..");d(accountBox.selectpicker("val"))})}})});function removeLoadingSpinner(){$(".spinner").remove()}
function generateLoadingSpinner(){var b=document.createElement("div");b.setAttribute("class","spinner");var c=document.createElement("div"),d=document.createElement("div"),a=document.createElement("div");c.setAttribute("class","bounce1");d.setAttribute("class","bounce2");a.setAttribute("class","bounce3");b.appendChild(c);b.appendChild(d);b.appendChild(a);return b}
function changeLoading(b,c){c=void 0===c?!1:c;b?($("body").css("overflow","none"),c&&loadingText.html(c),loading.style.display="block"):(loading.style.display="none",$("body").css("overflow","auto"))}function convertToSearchParam(b){var c=new URLSearchParams;b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next()){var a=$jscomp.makeIterator(d.value);d=a.next().value;a=a.next().value;c.set(d,a)}return c}
function setModalUI(b){(setDefaultModal=b=void 0===b?!1:b)?modalHeaderTitle.html(SET_DEFAULT_ROLE_HEADER):modalHeaderTitle.html(CHANGE_ROLE_HEADER)};
