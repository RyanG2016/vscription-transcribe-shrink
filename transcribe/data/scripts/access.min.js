var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in b))return;b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=
$jscomp.propertyToPolyfillSymbol[e],$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");(function(a){})(jQuery);
var accessDT,accessDTRef,createAcc,createAccModal,createAccForm,createAccBtn,updateAccBtn,modalHeaderTitle,accountsGlobal,rolesGlobal,ACCOUNTS_URL="../api/v1/accounts/?access-model",ROLES_URL="../api/v1/roles/",CITIES_URL="../api/v1/cities/",API_INSERT_URL="../api/v1/access/",CREATE_ACC_HEADER='<i class="fas fa-key"></i>&nbsp;Add Permission',UPDATE_ACC_HEADER='<i class="fas fa-user-edit"></i>&nbsp;Update Permission',accountBox,roleBox,update=!1,updateData,currentID,uid;
$(document).ready(function(){function a(a,d){a=void 0===a?!1:a;d=void 0===d?null:d;var b=new FormData(document.querySelector("#createAccForm"));b.append("uid",uid);createAccBtn.attr("disabled","disabled");updateAccBtn.attr("disabled","disabled");$.ajax({type:a?"PUT":"POST",url:a?API_INSERT_URL+d+"/":API_INSERT_URL,processData:!1,data:convertToSearchParam(b),success:function(a){resetForm();accessDTRef.ajax.reload();createAccModal.style.display="none";$.confirm({title:"Success",content:a.msg,buttons:{confirm:{btnClass:"btn-green",
action:function(){return!0}}}})},error:function(a){$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{btnClass:"btn-red",action:function(){createAccBtn.removeAttr("disabled");updateAccBtn.removeAttr("disabled");return!0}}}})}})}uid=$("#uidIn").val();createAccModal=document.getElementById("modal");accessDT=$("#access-tbl");createAcc=$("#createAcc");createAccForm=$("#createAccForm");createAccBtn=$("#createAccBtn");updateAccBtn=$("#updateAccBtn");modalHeaderTitle=$("#modalHeaderTitle");
accountBox=$("#accountBox");roleBox=$("#roleBox");$(".modal").niceScroll({hwacceleration:!0,smoothscroll:!0,cursorcolor:"white",cursorborder:0,scrollspeed:10,mousescrollstep:20,cursoropacitymax:.7});$("body").niceScroll({hwacceleration:!0,smoothscroll:!0,cursorcolor:"white",cursorborder:0,scrollspeed:10,mousescrollstep:20,cursoropacitymax:.7});$.ajaxSetup({cache:!1});var c=document.querySelector("#refresh_btn");new mdc.ripple.MDCRipple(document.querySelector("#refresh_btn"));$(".createAccForm input:not(input[type=radio])").each(function(){$(this).focus(function(){hideValidate(this)})});
$(".createAccForm input[type=radio]").each(function(){$(this).focus(function(){hideValidate(this,!0)})});accessDTRef=accessDT.DataTable({rowId:"acc_id",ajax:"../api/v1/access?dt&uid="+uid,processing:!0,lengthChange:!1,pageLength:10,autoWidth:!1,columnDefs:[{targets:["_all"],className:"mdc-data-table__cell"}],columns:[{data:"access_id"},{data:"acc_id"},{data:"acc_name"},{data:"username"},{data:"email"},{data:"acc_role"},{data:"role_desc"}]});$.contextMenu({selector:".access-tbl tbody tr",callback:function(a,
d){d=accessDTRef.row(this).data();switch(a){case "delete":var b=d.access_id;$.confirm({title:'<i class="fas fa-user-minus"></i> Revoke Access?',content:"Are you sure do you want to revoke access to <b>"+d.acc_name+"</b> as <b>"+d.role_desc+"</b> ?<br><br>",buttons:{confirm:{text:"yes",btnClass:"btn-red",action:function(){$.ajax({type:"DELETE",url:API_INSERT_URL+b,processData:!1,contentType:!1,success:function(a){accessDTRef.ajax.reload();$.confirm({title:"Success",content:a.msg,buttons:{confirm:{btnClass:"btn-green",
action:function(){return!0}}}})},error:function(a){accessDTRef.ajax.reload();$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{btnClass:"btn-red",action:function(){return!0}}}})}});return!0}},cancel:{text:"no",btnClass:"btn-green",function:function(){return!0}}}});break;case "edit":preFillForm(d)}},items:{edit:{name:"Edit",icon:"fas fa-key"},sep1:"---------","delete":{name:"Delete",icon:"fas fa-trash-alt"}}});c.addEventListener("click",function(a){accessDTRef.ajax.reload()});createAcc.on("click",
function(a){update=!1;updateAccBtn.css("display","none");createAccBtn.css("display","inline");createAccModal.style.display="block";$("#modal").stop().animate({scrollTop:0},500)});updateAccBtn.on("click",function(b){a(!0,currentID)});createAccBtn.on("click",function(b){a()});$(".cancel-acc-button").on("click",function(a){resetForm();createAccModal.style.display="none"});$.ajax({url:ACCOUNTS_URL,method:"GET",success:function(a){accountsGlobal=a;var b=document.getElementById("accountBox");a=$jscomp.makeIterator(a);
for(var c=a.next();!c.done;c=a.next())c=c.value,b.innerHTML+="<option value='"+c.acc_id+"'>"+c.acc_id+" - "+c.acc_name+"</option>";accountBox.selectpicker({liveSearch:!0,liveSearchPlaceholder:"Choose Account"});createAccBtn.removeAttr("disabled");updateAccBtn.removeAttr("disabled")}});$.ajax({url:ROLES_URL,method:"GET",success:function(a){rolesGlobal=a;var c=document.getElementById("roleBox");a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,c.innerHTML+="<option value='"+
b.role_id+"'>"+b.role_id+" - "+b.role_desc+"</option>";roleBox.selectpicker({liveSearch:!0,liveSearchPlaceholder:"Choose Role"})}})});function htmlEncodeStr(a){return a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&lsquo;")}
function resetForm(){modalHeaderTitle.html(CREATE_ACC_HEADER);updateAccBtn.css("display","none");createAccBtn.css("display","inline");createAccForm.find("input:not(input[type=radio])").val("");createAccForm.find("input[type=radio]").prop("checked",!1).change();createAccBtn.removeAttr("disabled");updateAccBtn.removeAttr("disabled")}
function preFillForm(a){update=!0;updateData=a;currentID=a.access_id;modalHeaderTitle.html(UPDATE_ACC_HEADER);updateAccBtn.css("display","inline");createAccBtn.css("display","none");accountBox.selectpicker("val",a.acc_id);roleBox.selectpicker("val",a.acc_role);createAccModal.style.display="block";$("#modal").stop().animate({scrollTop:0},500)}function hideValidate(a,c){((void 0===c?0:c)?$(a).parent():$(a)).removeClass("vtex-validate-error")}function isEmptyInput(a){return!$.trim(a.val())}
function convertToSearchParam(a){var c=new URLSearchParams;a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next()){var d=$jscomp.makeIterator(b.value);b=d.next().value;d=d.next().value;c.set(b,d)}return c}function removeLoadingSpinner(){$(".spinner").remove()}
function generateLoadingSpinner(){var a=document.createElement("div");a.setAttribute("class","spinner");var c=document.createElement("div"),b=document.createElement("div"),d=document.createElement("div");c.setAttribute("class","bounce1");b.setAttribute("class","bounce2");d.setAttribute("class","bounce3");a.appendChild(c);a.appendChild(b);a.appendChild(d);return a}function validateEmail(a){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a)?!0:!1};
