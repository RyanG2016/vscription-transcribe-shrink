var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};(function(a){})(jQuery);
var accessDT,accessDTRef,createAcc,createAccModal,sendInviteBtn,modalHeaderTitle,accountsGlobal,TYPISTS_URL="../api/v1/users/typists",INVITE_TYPISTS_URL="../api/v1/users/invite/",API_INSERT_URL="../api/v1/access/",SET_DEFAULT_ACCESS_URL="../api/v1/users/set-default/",CREATE_ACC_HEADER='<i class="fas fa-key"></i>&nbsp;Add Permission',UPDATE_ACC_HEADER='<i class="fas fa-user-edit"></i>&nbsp;Update Permission',accountBox,roleBox,loading,loadingText;
$(document).ready(function(){function a(){var a=new FormData;a.append("email",accountBox.val());changeLoading(!0,"Sending invite..");$.ajax({type:"POST",url:INVITE_TYPISTS_URL,data:a,processData:!1,contentType:!1,success:function(a){accessDTRef.ajax.reload();b();createAccModal.modal("hide");changeLoading(!1);$.confirm({title:"Success",content:a.msg,buttons:{confirm:{text:"Ok",btnClass:"btn-green"}}})},error:function(a){createAccModal.modal("hide");changeLoading(!1);$.confirm({title:"Error",content:a.responseJSON.msg,
buttons:{confirm:{btnClass:"btn-red",text:"Ok"}}})}})}function b(){$.ajax({url:TYPISTS_URL,method:"GET",success:function(a){accountsGlobal=a;var b=document.getElementById("accountBox");b.innerHTML="";a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,b.innerHTML+="<option value='"+d.email+"'>"+d.email+"</option>";accountBox.selectpicker({liveSearch:!0,liveSearchPlaceholder:"Find Typist"});accountBox.selectpicker("refresh")}})}createAccModal=$("#modal");accessDT=$("#access-tbl");
createAcc=$("#createAcc");sendInviteBtn=$("#sendInviteBtn");modalHeaderTitle=$("#modalHeaderTitle");loadingText=$("#loadingText");loading=$("#overlay");accountBox=$("#accountBox");roleBox=$("#roleBox");$(".modal").niceScroll({hwacceleration:!0,smoothscroll:!0,cursorcolor:"white",cursorborder:0,scrollspeed:10,mousescrollstep:20,cursoropacitymax:.7});$("body").niceScroll({hwacceleration:!0,smoothscroll:!0,cursorcolor:"white",cursorborder:0,scrollspeed:10,mousescrollstep:20,cursoropacitymax:.7});$.ajaxSetup({cache:!1});
var c=document.querySelector("#refresh_btn");new mdc.ripple.MDCRipple(document.querySelector("#refresh_btn"));accessDTRef=accessDT.DataTable({rowId:"access_id",ajax:"../api/v1/access?dt&jl&out",processing:!0,lengthChange:!1,pageLength:10,autoWidth:!1,columnDefs:[{targets:["_all"],className:"mdc-data-table__cell"}],columns:[{data:"email"},{data:"role_desc"}]});$.contextMenu({selector:".access-tbl tbody tr",callback:function(a,c){c=accessDTRef.row(this).data();switch(a){case "delete":var d=c.access_id;
$.confirm({title:'<i class="fas fa-user-minus"></i> Revoke Access?',content:"Are you sure do you want to revoke access to <b>"+c.acc_name+"</b> ?<br><br>",buttons:{confirm:{text:"yes",btnClass:"btn-red",action:function(){$.ajax({type:"DELETE",url:"../api/v1/access/"+d+"?out",processData:!1,contentType:!1,success:function(a){b();accessDTRef.ajax.reload();$.confirm({title:"Success",content:a.msg,buttons:{confirm:{btnClass:"btn-green",text:"Ok",action:function(){return!0}}}})},error:function(a){accessDTRef.ajax.reload();
$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{text:"Ok",btnClass:"btn-red",action:function(){return!0}}}})}});return!0}},cancel:{text:"no",btnClass:"btn-green",function:function(){return!0}}}});break;case "def":var e=c.acc_id,f=c.acc_role,g=c.uid;$.confirm({title:'<i class="fas fa-key"></i> Set as default?',content:"Are you sure do you want to set <b>"+c.access_id+"</b> as default access ?<br><br>",buttons:{confirm:{text:"yes",btnClass:"btn-green",action:function(){var a=new FormData;
a.append("acc_id",e);a.append("acc_role",f);a.append("uid",g);$.ajax({type:"POST",url:SET_DEFAULT_ACCESS_URL,processData:!1,data:convertToSearchParam(a),success:function(a){accessDTRef.ajax.reload();return!0},error:function(a){$.confirm({title:"Error",content:a.responseJSON.msg,buttons:{confirm:{text:"Ok",btnClass:"btn-red",action:function(){accessDTRef.ajax.reload();return!0}}}})}});return!0}},cancel:{text:"no",btnClass:"btn-red",function:function(){return!0}}}});break;case "edit":preFillForm(c)}},
items:{"delete":{name:"Revoke",icon:"fas fa-times"}}});c.addEventListener("click",function(a){accessDTRef.ajax.reload()});createAcc.on("click",function(a){update=!1;sendInviteBtn.css("display","inline");createAccModal.modal("show");$("#modal").stop().animate({scrollTop:0},500)});sendInviteBtn.on("click",function(b){a()});$("#closeAccModal").on("click",function(a){createAccModal.modal("hide")});b()});
function htmlEncodeStr(a){return a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&lsquo;")}function convertToSearchParam(a){var b=new URLSearchParams;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value;d=d.next().value;b.set(c,d)}return b}
function generateLoadingSpinner(){var a=document.createElement("div");a.setAttribute("class","spinner");var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div");b.setAttribute("class","bounce1");c.setAttribute("class","bounce2");d.setAttribute("class","bounce3");a.appendChild(b);a.appendChild(c);a.appendChild(d);return a}
function changeLoading(a,b){b=void 0===b?!1:b;a?($("body").css("overflow","none"),b&&loadingText.html(b),loading.fadeIn()):(loading.fadeOut(),$("body").css("overflow","auto"))}function validateEmail(a){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a)?!0:!1};
